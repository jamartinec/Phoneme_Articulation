---
---
title: "Defining age-dependent PLLR cut points"
author: "Jairo A. Martínez"
format:
  revealjs:
    slide-number: true
    theme: simple
execute:
  echo: false
  warning: false
  message: false
---

## 1. Background: PLLR growth curves

- - Our data consist of **PLLR scores** produced by a wav2textgrid aocustic model applied to child speech recordings.  
  PLLR reflects how close each phoneme production is to its expected acoustic target.
- For each phoneme we model a **growth curve** of Phoneme Goodness Score (function of PLLR) vs. age using a **Bayesian Beta regression**.
- The model provides posterior mean and credible bands.
- Example: growth curve for **/S/**.

::: {.center}
![](figures/pllr_growth_s.png){width=80%}
:::

---

## 2. What does the growth curve mean?

- For most phonemes, the **PLLR goodness score increases with age**.
- This increase has (at least) two components:

  - **Linguistic component**  
    - improved articulation  
    - progress in phonological acquisition / intelligibility  

  - **Physiological component**  
    - maturation / growth of the vocal tract (?), etc.


### Main Question

For each **phoneme** and **age**, we want to find a **cut point** in the goodness score that marks the transition between:

1. **improving intelligibility / acquisition**  , and  

2. **Mainly physiological maturation**  
   (score improves because the child grows, not because the phoneme is being newly acquired (?)).

Equivalently:

> Where is the **functional cut point** for each phoneme, i.e. the level of Phoneme Goodnes Score (PLLR) beyond which further increases reflect mostly physiological growth rather than phonological acquisition?

---

## 3. Crowe & McLeod (2020): normative acquisition curves

Crowe & McLeod analyzed data from 15 studies (≈18,900 children) and reported,
for each English consonant:

- the **mean age** at which children reach  
  **50%, 75%, and 90% accuracy** in producing that phoneme, and  
- the corresponding **standard deviations** across studies.

**Interpretation of the criteria**  
- *90% criterion*: “Typically, **90% criterion indicates that 90% of the participants produced the consonant correctly**.”  
  (Crowe & McLeod, 2020)

These normative values summarize **typical phoneme acquisition ages** in the U.S. population and serve as **reference anchors** for our cut-point definition.

Below we plot, for each phoneme, the age ranges  
**(mean ± 2 SD)** associated with the 50%, 75%, and 90% accuracy criteria.

```{r}
#| label: setup
library(tidyverse)
library(ggplot2)
library(scales)
library(ggrepel)

#| label: crow-read
read_crow_mcleod <- function(file_path = "Modeling_Pipeline/data/processed_data/crow-mcleod.csv") {
crow_mcleod <- read.csv(file_path)

crow_mcleod_long <- crow_mcleod %>%
transmute(
expected_phoneme = phoneme,
group,
`0.50` = fifty_percent,
`0.75` = seventyfive_percent,
`0.90` = ninety_percent
) %>%
pivot_longer(
cols = c(`0.50`, `0.75`, `0.90`),
names_to = "prob_x_eq_1_hat",
values_to = "age_months"
) %>%
mutate(prob_x_eq_1_hat = as.numeric(prob_x_eq_1_hat),
age_months = as.numeric(round(age_months, 0)))

crow_mcleod_long_sd <- crow_mcleod %>%
transmute(
expected_phoneme = phoneme,
group,
`0.50` = fifty_sd,
`0.75` = seventyfive_sd,
`0.90` = ninety_sd
) %>%
pivot_longer(
cols = c(`0.50`, `0.75`, `0.90`),
names_to = "prob_x_eq_1_hat",
values_to = "age_months_sd"
) %>%
mutate(prob_x_eq_1_hat = as.numeric(prob_x_eq_1_hat),
age_months_sd   = as.numeric(round(age_months_sd, 0)))

crow_joined <- crow_mcleod_long %>%
left_join(crow_mcleod_long_sd,
by = c("expected_phoneme", "group", "prob_x_eq_1_hat")) %>%
mutate(
age_months_m2sd = age_months - 2 * age_months_sd,
age_months_p2sd = age_months + 2 * age_months_sd
)

crow_joined
}

crow_joined <- read_crow_mcleod()

#| label: crow-plot
#| fig-width: 8
#| fig-height: 6
crow_plot_data <- crow_joined %>%
mutate(
cm_cut = case_when(
prob_x_eq_1_hat == 0.50 ~ "C&M age range 50%  accuracy",
prob_x_eq_1_hat == 0.75 ~ "C&M age range 75%  accuracy",
prob_x_eq_1_hat == 0.90 ~ "C&M age range 90%  accuracy"
)
)

ggplot(crow_plot_data,
aes(y = expected_phoneme)) +
geom_segment(
aes(x = age_months_m2sd,
xend = age_months_p2sd,
yend = expected_phoneme,
colour = cm_cut),
linewidth = 1.2
) +
geom_point(
aes(x = age_months, colour = cm_cut),
size = 2.5
) +
scale_colour_manual(
name = "C&M cuts",
values = c(
"C&M age range 50%  accuracy" = "red",
"C&M age range 75%  accuracy" = "darkgreen",
"C&M age range 90%  accuracy" = "purple"
)
) +
labs(
x = "Age (months)",
y = "Phoneme",
title = "Crowe & McLeod (2020): normative ages and variability"
) +
theme_minimal(base_size = 14)

```

## 4. AAPS: probability of success vs. age
**Arizona Articulation and Phonology Scale (AAPS)** : standardized
assessment that evaluates whether a child correctly produces a target phoneme in a structured elicitation task. 

We are using the results of AAPS scoring to 
**N = [----]** children from  
**[population (?)]**.
From these binary (0/1) outcomes we fit a **Bayesian Binomial model**  
to estimate, for each phoneme:

- the **probability of correct production** as a function of age,
- posterior uncertainty around this probability.

Below we show an example growth curve for phoneme **/S/** 

## 5. Integrating normative and model-based information

Our goal is to define, for each phoneme and each age,  
a **PLLR cutpoint** that reflects the transition between:

- **linguistic acquisition**, and  
- **physiological maturation**.

To do this, we combine three components:

1. **Crowe & McLeod (2020)**  
   Normative ages when children reach **50%, 75%, 90% accuracy**.
   These serve as *population-level reference ages*.

2. **AAPS Bayesian Binomial model**  
   For each age, we estimate  
   \[
     q(\text{age}) = P(\text{100% correct production} \mid \text{age}),
   \]
   which captures the *probability of mastery* in our sample.

3. **PLLR Bayesian Beta model**  
   For each age, we compute the PLLR threshold \(x_q(\text{age})\) satisfying:
   \[
   P(\text{PLLR} \ge x_q(\text{age}) \mid \text{age}) 
     = q(\text{age}).
   \]

This gives an **age-dependent PLLR cutpoint** that is anchored to both  
clinical norms and observed performance.

```{perl}
Crowe & McLeod  →  age criteria (50/75/90)
         ↓
AAPS binomial model → q(age)
         ↓
PLLR beta model → x_q(age)
         ↓
Age-dependent cutpoint
```

## 5. Integrating normative and model-based information

<div style="display:flex; flex-direction:column; gap:22px; align-items:center; font-size:1.1em;">

<div style="border:1px solid #ccc; padding:12px; width:75%; text-align:center;">
<b>Crowe & McLeod (2020)</b><br>
Ages at 50%, 75%, 90% accuracy<br>
<small>(population norms)</small>
</div>

<div>⬇️</div>

<div style="border:1px solid #ccc; padding:12px; width:75%; text-align:center;">
<b>AAPS Binomial Bayesian Model</b><br>
q(age) = P(100% correct | age)
</div>

<div>⬇️</div>

<div style="border:1px solid #ccc; padding:12px; width:75%; text-align:center;">
<b>PLLR Beta Bayesian Model</b><br>
Find x<sub>q</sub>(age) such that P(PLLR ≥ x | age) = q(age)
</div>

<div>⬇️</div>

<div style="border:1px solid #ccc; padding:12px; width:75%; text-align:center; background:#f7f7f7;">
<b>Age-dependent PLLR Cutpoint</b><br>
Transition between linguistic acquisition and physiological growth
</div>

</div>

## 6. PLLR cutpoints for phoneme /ɹ/

This figure combines:

1. the **Bayesian PLLR growth curve** (posterior median and 95% credible band),
2. the **raw PLLR scores** (grey points),
3. and the **Crowe & McLeod age criteria** (50%, 75%, 90% acquisition).

For each C&M age point, we compute the corresponding  
**age-dependent PLLR threshold** \(x_q(\text{age})\) that matches the  
probability of mastery predicted by the AAPS model.

These age-specific thresholds define the **cutpoints** where PLLR values  
transition from reflecting **active phonological acquisition**  
to reflecting **primarily physiological maturation**.

:: notes

**Cómo explicar la gráfica en voz alta:**

- El fondo rosado es la **curva de crecimiento del goodness score PLLR** para /ɹ/.  
  - La banda ancha es la **credibilidad del 95%**,  
  - y la línea oscura es el **posterior median**.

- Los puntitos grises son los **datos reales** de PLLR de los niños.

- En la parte inferior aparecen los **puntos normativos** de Crowe & McLeod:  
  - **rojo** = edad media donde 50% de los niños producen /ɹ/ correctamente,  
  - **verde** = 75%,  
  - **morado** = 90%.

- Para cada uno de esos puntos, calculamos la **probabilidad de dominio** usando AAPS:  
  \( q(\text{age}) = P(\text{100% correct production} \mid \text{age}) \)

- Luego buscamos el punto \( x_q(\text{age}) \) en la distribución posterior de PLLR tal que:  
  \[
    P(\text{PLLR} \ge x_q(\text{age}) \mid \text{age}) = q(\text{age})
  \]

- Esos puntos son las **etiquetas con coordenadas** como (48m, 0.02), (67m, 0.02), etc.  
  Representan el **cutpoint** para ese fonema y esa edad.

- **Interpretación clínica:**  
  A edades tempranas, los cutpoints son cercanos a 0 → el fonema no está adquirido.  
  En edades donde C&M reportan adquisición más alta, el cutpoint sube → se requiere un PLLR mayor para que el desempeño refleje habilidad lingüística y no solo crecimiento físico.

- El objetivo es identificar **la zona de transición** entre:  
  - mejora articulatoria/lingüística  
  - vs. aumento del PLLR por crecimiento fisiológico.

